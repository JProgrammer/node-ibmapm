#!/usr/bin/expect

set timeout 360

set ip [lindex $argv 0]
set user [lindex $argv 1]
set password [lindex $argv 2]
set cmd [lrange $argv 3 end]

eval spawn ssh -l $user $ip $cmd << EOF
expect {
  "password:" {
    send "$password\r"
    set timeout -1
  } "yes/no)?" {
    send "yes\r"
    set timeout -1
  } -re . {
    exp_continue
  } 
}

interact
